# Study Monitor for QNDXX

Study Monitor 是一个用于监控和对比组织成员学习情况的工具。该应用允许用户输入账号信息，选择期数和组织，获取组织成员的学习情况，并通过上传花名册文件进行对比。最终，用户可以查看和下载对比结果。

## 功能概述

- **用户信息输入**：用户可以输入用户名和密码，以获取组织的学习情况。
- **组织选择**：用户可以选择特定的期数 (Sid) 和组织 (Orgid)。
- **获取学习情况**：应用会根据输入的信息获取组织成员的学习情况。
- **文件上传**：用户可以上传自己的花名册文件进行对比。
- **对比结果**：应用会对比花名册文件和获取的学习情况，显示未匹配的列表。
- **使用说明**：提供详细的使用说明，帮助用户了解如何操作应用。

## 使用步骤

### 1. 输入用户信息

在“输入”面板中，用户需要输入以下信息：
- **用户名 (Username)**：输入您的用户名。
- **密码 (Password)**：输入您的密码。

### 2. 查看所属组织

- **期数 (Sid)**：选择您所需的期数。期数的格式为 `snum (sid: id)`，例如 `2024 (sid: 1)`。
- **选择组织 (Orgid)**：点击“Select Orgid”按钮，打开选择组织的模态框。在模态框中，您可以通过搜索框快速查找组织。勾选您需要核对的组织，点击“Ok”按钮确认选择。

### 3. 获取组织的学习情况

确认已输入用户名、密码，并选择了期数和组织。点击“Fetch Lists”按钮，获取所选组织的学习情况。

### 4. 上传花名册

在“输入”面板中，找到文件上传组件。点击上传区域，选择您准备的花名册文件。上传成功后，您可以在页面上预览上传的文件。

### 5. 核对学习情况

确认已上传花名册文件，并获取了组织的学习情况。点击“Compare”按钮，系统会根据获取的组织和花名册中的人员信息，核对学习时间和完成情况。核对结果会显示在“输出”面板中。

### 6. 预览和下载对比结果

在“输出”面板中，您可以查看核对后的结果列表。未匹配的列表会显示在页面上，方便您进行进一步处理。点击下载按钮，即可下载对比结果文件。

## 代码结构

### 主组件 (App.tsx)

- **状态管理**：使用 React 的 `useState` 和 `useEffect` 钩子管理应用的状态，如用户信息、文件、组织数据等。
- **数据获取**：通过 `fetchCompleteLists` 和 `fetchCombinedData` 函数从服务器获取组织和学习数据。
- **文件上传和对比**：使用 `FileUpload` 组件上传文件，并通过 `compareExcels` 函数进行文件对比。
- **布局和样式**：使用 Ant Design 的 `Layout`、`Row`、`Col` 等组件进行页面布局，并通过 `Modal` 组件实现模态框功能。

### 子组件

- **FileUpload**：处理文件上传。
- **FilePreview**：预览上传的文件。
- **CompareResult**：显示对比结果。

### 服务 (services)

- **excelHandler.ts**：处理 Excel 文件的对比逻辑。
- **api.ts**：封装 API 调用，获取组织和学习数据。
- **types.ts**：定义数据类型。

## 免责声明

此项目仅用于学习和研究目的。开发者对任何人使用此项目造成的任何直接或间接后果不负责任。请勿将此项目用于任何非法用途或违反相关法规的行为。使用本项目即表示您同意自行承担使用过程中可能产生的所有风险和责任。

## 注意事项

- 请确保输入的用户名和密码正确，以便成功获取组织的学习情况。
- 上传的花名册文件应为 Excel 格式，确保文件内容格式正确，以便系统进行有效核对。
- 核对过程中，请耐心等待，系统会处理并显示结果。